<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.54.0" />

  <title>Install Windows Admin Center on Windows Server Core &middot; Grey Wall IT</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://GreyWallIT.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://GreyWallIT.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://GreyWallIT.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/vs2015.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/go.min.js"></script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/json.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://GreyWallIT.github.ioimg/favicon.ico" type="image/x-icon" />

  
    
        <link rel="stylesheet" href="https://GreyWallIT.github.iocss/my.css">
    
  
  
    
        <script src="https://GreyWallIT.github.iojs/my.js"></script>
    
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://GreyWallIT.github.io/">Grey Wall IT</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://GreyWallIT.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://GreyWallIT.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://GreyWallIT.github.io/topics/"><i class='fa fa-bookmark fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://GreyWallIT.github.io/about"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://GreyWallIT.github.io/contact"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/GreyWallIT" target="_blank"><i class="fa fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/GreyWallIT" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackexchange.com/users/10307370/grwa" target="_blank"><i class="fa fa-stack-exchange fa-fw"></i>Stack Exchange</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2019. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Install Windows Admin Center on Windows Server Core</h1>
  <h2></h2>
</div>
<div class="content">
  

<p>The Windows Admin Center is a free tool from Microsoft that I like to think of as the next iteration of Windows Server Manager or the RSAT tools. It lets you manage your servers, clusters, hyper-converged infrastructure, Windows 10 computers, and a host of other features and functions come with that. If you have co-workers that manage servers but are intimidated by the command line it makes it difficult to be able to deploy Windows Server Core in your environment as it may lessen the ability of the team to manage those servers. Windows Admin Center gives the GUI back to Windows Server Core installations (somewhat).</p>

<p>After logging in to your server run PowerShell.</p>

<pre><code>C:\temp\powershell.exe
</code></pre>

<h3 id="step-1-download-windows-admin-center">Step 1 - Download Windows Admin Center</h3>

<p>Download the latest version of the Windows Admin Center MSI from Microsoft to your preferred directory. I am putting it in C:\temp.</p>

<pre><code>Invoke-WebRequest https://aka.ms/wacdownload -UseBasicParsing -OutFile C:\temp\WAC.msi
</code></pre>

<h3 id="step-2-get-a-certificate">Step 2 - Get a Certificate</h3>

<p>We don&rsquo;t have a certificate authority setup for this walkthrough, so we&rsquo;ll make a new self-signed certificate to use. Windows Admin Center requires an HTTPS connection. In this example we&rsquo;re creating a certificate that will be valid for two years from today&rsquo;s date. The <em>Get-Date</em> cmdlet returns today&rsquo;s date. When we surround that with parentheses we can use the <em>AddDays</em> method to add as many days after today&rsquo;s date as we want. 730 days is (roughly) two years from today&rsquo;s date.</p>

<pre><code>New-SelfSignedCertificate -CertStoreLocation 'Cert:\LocalMachine\My' -Type SSLServerAuthentication -DnsName 'WACSRV' -NotAfer (Get-Date).AddDays(730)
</code></pre>

<h3 id="step-3-get-a-thumbprint">Step 3 - Get a Thumbprint</h3>

<p>Get the thumbprint of the certificate you want to use and store it in a variable for later use. I will use the self-signed certificate I just made</p>

<pre><code>$thumbprint = (Get-ChildItem Cert:\LocalMachine\My\ -SSLServerAuthentication).Thumbprint
</code></pre>

<h3 id="step-4-install-windows-admin-center">Step 4 - Install Windows Admin Center</h3>

<p>Install Windows Admin Center using MSIEXEC. The number for SME_PORT can be whichever port you want to run the admin center on. I&rsquo;m using port 9999.</p>

<p><strong>NOTE: The documentation states that dot notation for installing with MSIEXEC will not work if you are executing from PowerShell, so be sure to put the full path in for the location of the MSI file.</strong></p>

<pre><code>msiexec.exe /I C:\temp\WAC.msi /qn SME_PORT=9999 SME_THUMBPRINT=$thumbprint SSL_CERTIFICATEOPTION=installed /Lvx C:\temp\WAC.log
</code></pre>

<h3 id="step-5-verify-the-wac-is-running">Step 5 - Verify the WAC is Running</h3>

<p>You can review the log to see if the installation was successful, or try to connect to the admin center with Invoke-WebRequest (I installed to port 9999, so I am connecting to port 9999)</p>

<pre><code>Invoke-WebRequest https://localhost:9999
</code></pre>

<p>If you get a powershell error &ldquo;Could not establish trust relationship for the SSL/TLS secure channel&rdquo; or &ldquo;The remote server returned an error: (401) Unauthorized&rdquo; you know it is up and running. The error in our case for this post is from the Windows Admin Center running with a self-signed certificate. If you access this site from an Edge (version 1709 or later) or Chrome browser you should get a prompt to login and view the Admin Center in all its glory. The login credentials will be any administrative credentials of the server running WAC.</p>

<p><img src="https://GreyWallIT.github.io/img/windows/WAC042019.png" alt="&quot;Windows Admin Center&quot;" /></p>

</div>

</div>
</div>
<script src="https://GreyWallIT.github.iojs/ui.js"></script>
<script src="https://GreyWallIT.github.iojs/menus.js"></script>





</body>
</html>

