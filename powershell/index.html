<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.64.1" />

  <title> &middot; Grey Wall IT</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://GreyWallIT.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://GreyWallIT.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://GreyWallIT.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.9.0/css/all.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  
  <link rel="alternate" type="application/rss+xml" title="Grey Wall IT"
    href='https://GreyWallIT.github.io/powershell/index.xml' />
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/vs2015.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/go.min.js"></script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/json.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://GreyWallIT.github.io/img/favicon.ico" type="image/x-icon" />

  
    
        <link rel="stylesheet" href="https://GreyWallIT.github.io/css/my.css">
    
  
  
    
        <script src="https://GreyWallIT.github.io/js/my.js"></script>
    
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://GreyWallIT.github.io/">Grey Wall IT</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://GreyWallIT.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://GreyWallIT.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://GreyWallIT.github.io/topics/"><i class='fa fa-bookmark fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://GreyWallIT.github.io/about"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://GreyWallIT.github.io/contact"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href='https://GreyWallIT.github.io/powershell/index.xml'><i
          class="fas fa-rss"></i>RSS</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/GreyWallIT" rel="me" target="_blank"><i class="fab fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/GreyWallIT" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7604201/grwa" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2019. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


    <h1>
        <a href="https://GreyWallIT.github.io/powershell/"></a>
    </h1>


    <a href="https://GreyWallIT.github.io/powershell/batchfilerename/">Batch Renaming Files in PowerShell</a>
    <p>The other day I had a request to rename some files (i.e. &ldquo;we have millions of files that all need to be renamed can you do that?&quot;).</p>
<p>I said of course, and thankfully it was the same change that needed to be done for every file. The leading 1 of the files needed to be replaced with a 0. There was a large conversion going on from one software program to another and this was part of how they were tracking the migrations of the files.</p>
<p>Here is how I made this request happen:</p>
<pre><code>Get-ChildItem C:\PARENT_FOLDER -File -Recurse | ForEach-Object { Rename-Item $_.FullName ($_.Name -Replace &quot;^1&quot;,&quot;0&quot;) }
</code></pre><p>Here is what is happening.</p>
<p>This part of the command will go through the C:\PARENT_FOLDER and every subfolder of it, picking out each file:</p>
<pre><code>Get-ChildItem C:\PARENT_FOLDER -File -Recurse
</code></pre><p>We then pipe that to take action on each file with the &ldquo;|&rdquo; character and the ForEach-Object cmdlet:</p>
<pre><code>| ForEach-Object
</code></pre><p>The last bit in between the <strong>{}</strong> characters is where the renaming happens. The <strong>$_</strong> part takes the current file being worked on. The <strong>$_.FullName</strong> part takes the full name of the item which is also known as the path, for example <strong>C:\PARENT_FOLDER\Subfolder1\123456789.pdf</strong>. Since this comes first after the <strong>Rename-Item</strong> cmdlet, it will be the file that is going to be renamed. The last bit between the <strong>()</strong> characters is what we will rename the file to.</p>
<p><strong>$_.Name</strong> refers to the file name of the current item being worked on, <strong>123456789.pdf</strong> for this example. The <strong>-Replace</strong> parameter takes this file and replaces the leading 1 - the <strong>&ldquo;^1&rdquo;</strong> part - with a 0 - the <strong>&ldquo;0&rdquo;</strong> part. The <strong>&ldquo;^1&rdquo;</strong> is a regular expression. The <strong>^</strong> character says look at the beginning, and the <strong>1</strong> says find a 1. By putting <em><strong>&ldquo;^1&rdquo;</strong></em> we are saying &ldquo;find a 1 that starts the name&rdquo;. If the current file does start with a 1 it will match that 1 and replace it with a 0. If we wanted to replace the 1 with the letter Z we would change that part of the cmdlet to be:</p>
<pre><code>-Replace &quot;^1&quot;,&quot;Z&quot;
</code></pre><p>If we wanted to replace the &ldquo;12&rdquo; at the beginning of the file name with the letter Z we could change it to be:</p>
<pre><code>-Replace &quot;^12&quot;,&quot;Z&quot;
</code></pre><p>PowerShell made thist task really easy to accomplish. It did take a few hours to run through the millions of files, but without being able to script the rename in some way it never would have been able to happen.</p>
<p>Do you know of a better way this could have been accomplished? Let me know.</p>

    <br>

    <a href="https://GreyWallIT.github.io/powershell/formatenumerationlimit/">FormatEnumerationLimit - Reduce Truncating Output</a>
    <p>Sometimes there is output from a cmdlet that gets truncated on the screen, even though there is more space to fill in the console window.</p>
<p><img src="https://GreyWallIT.github.io/img/powershell/truncatedoutput.png" alt=""></p>
<p>To not truncate the output of your PowerShell commands set the variable <strong>$FormatEnumerationLimit</strong> to <strong>-1</strong></p>
<pre><code>$FormatEnumerationLimit=-1
</code></pre><p>Now the output from cmdlets will fill the console window.</p>
<p><img src="https://GreyWallIT.github.io/img/powershell/untruncatedoutput.png" alt=""></p>
<p>So what is the <strong>$FormatEnumerationLimit</strong> variable? Here is the definition from the <em>about_preferences</em> doc:</p>
<blockquote>
<p>$FormatEnumerationLimit
Determines how many enumerated items are included in a display. This variable does not affect the underlying objects; just the display. When the value of $FormatEnumerationLimit is less than the number of enumerated items, PowerShell adds an ellipsis (&hellip;) to indicate items not shown.</p>
<p>Valid values: Integers (Int32)</p>
<p>Default value: 4</p>
</blockquote>
<p><em><strong>Link:</strong></em> <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_preference_variables?view=powershell-6#formatenumerationlimit">About Preference Variables - $FormatEnumerationLimit</a></p>
<p>This means that when your output has an object with multiple items in it, like an array, the number of those items to be shown will be at most the number you assign to that variable. Assigning a value of -1 essentially says &ldquo;show me everything as long as I have space&rdquo;. Here is a comparison between a value of 4, the default, and -1.</p>
<p><img src="https://GreyWallIT.github.io/img/powershell/enumerationcomparison.png" alt=""></p>

    <br>
 

</div>
</div>
<script src="https://GreyWallIT.github.io/js/ui.js"></script>
<script src="https://GreyWallIT.github.io/js/menus.js"></script>





</body>
</html>
